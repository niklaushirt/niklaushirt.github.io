<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Nick on GitHub</title>
    <description>Nick&#39;s repositories on GitHub.
</description>
    <link>http://nik.cloud/</link>
    <atom:link href="http://nik.cloud/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 30 Mar 2016 12:12:30 +0200</pubDate>
    <lastBuildDate>Wed, 30 Mar 2016 12:12:30 +0200</lastBuildDate>
    <generator>Jekyll v3.1.2</generator>
    
      <item>
        <title>Easy UrbanCode Deploy with Vagrant (part 1)</title>
        <description>&lt;p&gt;&lt;img src=&quot;/assets/vagrant_article_header.jpg&quot; alt=&quot;header&quot; /&gt;&lt;/p&gt;

&lt;p&gt;This article describes my process of automatically creating deployment targets for an IBM UrbanCode Deploy environment.&lt;/p&gt;

&lt;p&gt;All the sourcecode is freely available in my &lt;a href=&quot;https://github.com/niklaushirt/UrbanCode_Vagrant&quot; target=&quot;_blank&quot;&gt;GitHub repository&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;prerequisites&quot;&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;Vagrant must be &lt;a href=&quot;https://www.vagrantup.com/docs/getting-started/index.html&quot; target=&quot;_blank&quot;&gt;installed on your local machine&lt;/a&gt;. 
It can be downloaded and installed from &lt;a href=&quot;https://www.vagrantup.com/downloads.html&quot; target=&quot;_blank&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;building-the-bases&quot;&gt;Building the bases&lt;/h2&gt;

&lt;p&gt;In order to optimise performance, in this first article we will first build a base box image containing some basic stuff:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Java JRE&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And optional (to speed-up VM creation):&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Docker engine&lt;/li&gt;
  &lt;li&gt;Docker compose&lt;/li&gt;
  &lt;li&gt;NodeJS&lt;/li&gt;
  &lt;li&gt;NPM&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;create-the-vagrant-file&quot;&gt;1_ Create the Vagrant File&lt;/h3&gt;

&lt;p&gt;First we start with the “config” section in which we define that the base image is based on Ubuntu 14.04.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Vagrant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
 
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;box&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ubuntu/trusty64&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;For this article I chose to create an inline shell script in order to make it a simple on-file solution to start with.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;c&quot;&gt;# Provision the Base image&lt;/span&gt;
  config.vm.provision &lt;span class=&quot;s2&quot;&gt;&quot;shell&quot;&lt;/span&gt;, inline: &lt;span class=&quot;sh&quot;&gt;&amp;lt;&amp;lt;-SHELL
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;So first we update the package manager and install the unzip binary.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;c&quot;&gt;#UPDATE    &lt;/span&gt;
    sudo apt-get update
    &lt;span class=&quot;c&quot;&gt;#GET UNZIP&lt;/span&gt;
    sudo apt-get install unzip
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Next we install the Java JRE needed to run the UrbanCode Deploy Agent&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c&quot;&gt;#INSTALL JAVA&lt;/span&gt;
    sudo apt-get install --fix-missing -y
    sudo apt-get install openjdk-6-jre-headless -y
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;optional-steps&quot;&gt;Optional Steps&lt;/h4&gt;

&lt;p&gt;For my specific example, I need install the following additional elements:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Docker engine&lt;/li&gt;
  &lt;li&gt;Docker compose&lt;/li&gt;
  &lt;li&gt;NodeJS&lt;/li&gt;
  &lt;li&gt;NPM&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Install the Docker Engine&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   &lt;span class=&quot;c&quot;&gt;#INSTALL DOCKER&lt;/span&gt;
    sudo apt-key adv --keyserver hkp://pgp.mit.edu:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
    sudo &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;deb https://apt.dockerproject.org/repo ubuntu-trusty main&#39;&lt;/span&gt; &amp;gt; /etc/apt/sources.list.d/docker.list
    sudo apt-get update
    sudo apt-get install docker-engine -y
    sudo service docker stop
    sudo service docker start
    sudo usermod -aG docker vagrant
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Install Docker Compose&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;     &lt;span class=&quot;c&quot;&gt;#INSTALL DOCKER COMPOSE&lt;/span&gt;
    curl -L https://github.com/docker/compose/releases/download/1.6.2/docker-compose-&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;uname -s&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;uname -m&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &amp;gt; docker-compose
    sudo mv docker-compose /usr/local/bin/docker-compose
    sudo chmod +x /usr/local/bin/docker-compose
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Install NodeJS and NPM&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   &lt;span class=&quot;c&quot;&gt;#INSTALL NODE/NPM&lt;/span&gt;
    sudo apt-get install nodejs -y
    sudo apt-get install npm -y
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;And I pull some Docker images to speed up deployment&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;c&quot;&gt;#PULL DOCKER IMAGES&lt;/span&gt;
    docker pull node
    docker pull dockerui/dockerui
    docker pull tutum/haproxyXXX
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h3 id=&quot;create-the-the-base-box&quot;&gt;2_ Create the the Base Box&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/vagrant_Base_build.jpg&quot; alt=&quot;terminal build&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Create a directory for the project and copy the above code into a file called &lt;em&gt;Vagrant&lt;/em&gt; and finally run &lt;em&gt;vagrant up&lt;/em&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mkdir 1_BASE_BOX
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;1_BASE_BOX
nano Vagrant
&lt;span class=&quot;c&quot;&gt;#Paste the File Content&lt;/span&gt;
vagrant up
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;or download the code from GitHub&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/niklaushirt/UrbanCode_Vagrant.git
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;1_BASE_BOX
vagrant up
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;When done, we’ll create a box image of the base&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;vagrant package --output base_agent.box
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;part-2-of-this-article-is-herehttpniklaushirtgithubiourbancodevagrant20160330vagrantucdpart2html&quot;&gt;Part 2 of this article is &lt;a href=&quot;http://niklaushirt.github.io/urbancode/vagrant/2016/03/30/vagrant_ucd_part2.html&quot;&gt;here&lt;/a&gt;&lt;/h1&gt;

</description>
        <pubDate>Wed, 30 Mar 2016 08:45:12 +0200</pubDate>
        <link>http://nik.cloud/urbancode/vagrant/2016/03/30/vagrant_ucd_part1.html</link>
        <guid isPermaLink="true">http://nik.cloud/urbancode/vagrant/2016/03/30/vagrant_ucd_part1.html</guid>
        
        
        <category>urbancode</category>
        
        <category>vagrant</category>
        
      </item>
    
  </channel>
</rss>
